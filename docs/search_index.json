[
["index.html", "Playing Data with R About 自述 學程式這回事", " Playing Data with R JILUNG HSIEH 2020-02-17 About 自述 2016年有幸可以到臺灣大學新聞所帶領一群未來的記者學習資料分析的技巧。說是資料分析，不如說是程式設計。當時紐約時報、國際上各大報紙大量地產製資料新聞，嘗試用資料搭配視覺化來敘事，或者透過資料探勘方法，挖掘數字、資料背後的異常現象、趨勢、分佈等等。 為了兼顧每一位學生的學習情形，特地採用小班教學，但卻有不少外系的學生也一起到課堂上來學習，因而以每個學期開課、每堂課最多三十人的模式授課。這樣頻繁授課的好處是，可以反覆地、快速地嘗試各種不同的授課方式，並且在次學期授課中進行調整。而這本書則是在授課過程零星所記錄下來的經驗和知識。 2016年開始在臺大教書的那個暑假，我其實擅長的程式語言是Python，且有二至三年開授「社會科學程式設計:ProgrammingforSocialScience」的經驗。但到任前單位主管希望我能夠以R為主要授課語言，單位主管和紐約時報的圖表編輯部門有數年的互動，她告訴我紐約時報圖表記者們都用R語言。而在2016年的當時，北臺灣業界和研究單位所開授的網路爬蟲、資料分析、機器學習等課程，都是以R為主要語言。顯然當時以Python為主要語言的「深度學習」族群尚未在臺灣發展起來(在2018年的現在，也就是我寫下這句話之時，其實臺灣熱門的是Python程式語言)。 那年暑假，我用了Datacamp來產生我對R語言的基礎認識、聽了二至三門Coursera上的R語言課程來了解R語言的授課方式、參考了三至四份以R為語言的國外課程教材、甚至自費參與由臺灣業界一群熱心的工程師所開發的網路爬蟲課程、與當時臺灣資料科學年會所開發的「手把手教你資料分析」課程觀摩他人上課的節奏和使用範例，我非常感謝有這群先行者的努力和無私的分享，讓我在後續的課程安排上駕輕就熟。 在2016年國外所開設以R來進行資料分析的課程也不算多，但在2018年的今日，Stanford的PoliticalScience與Chicago的MasterofComputationalSocialScience均開設了質量非常高的R在社會科學應用上的課程，Stanford的PoliticalScience甚至將其拆解為150A、150B、150C三門課程來授課。 基於這樣的出發點，所以這本書的核心對象就是從沒有寫過程式的大學生。 學程式這回事 何謂演算法？ 演算法（Algorithm）為處理事情、解決問題的邏輯，多取自日常生活的問題解決步驟。例如Google用以排名搜尋結果的「PageRanking」即參考自人與人之間，如何透過每次的訊息交換，建立起人的聲望。而推薦機制的核心概念「協同式推薦」，則仿自市集群眾購物行為的共同喜好、熱門物品等機制。 而程式語言（ProgrammingLanguage）則是演算法的實作。定義一套機器能夠編譯的語法，將演算法實作出來。脫離程式語法的演算法也可以被英文邏輯性地加以表徵，被稱之為「Pseudo-code」。一段典型的Pseudo-code如下，描述了ATM提款機如何提款與存款的決策步驟。 Ifoption=depositthen Output&#39;Enteramounttodeposit&#39; Inputamount balance=balance+amount Ifoption=withdrawalthen Output&#39;Enteramounttowithdraw&#39; Inputamount balance=balance-amount Output&#39;Balanceis&#39;balance 因此，程式語言的學習，則類似將日常生活的處事方法，用正確的邏輯方式來表達，並用一種指定的語言來描述。準此，程式語言的學習是「語言與邏輯」。而回想我們如何學會英文或者有天突然覺得自己將英文的運用推到另一個層次之上時，往往有一番自己的方法和領會，多半來自於個人目標與適合個人的學習方法，例如，考TOEIC、TOFEL、GRE，看美國影集、看英文原版小說，或者為了打電玩。 掌握課外學習資源 現在網路上自學資源非常多，尤其是各家線上開放課程，或者是code.org、Datacamp等線上互動學習平台，所以我在授課的過程，我多半是在課堂上強調程式語言中的關鍵技術、使用方法、使用時機和比較彼此間的差異，我甚少把一個概念和各種可用的函式在課堂上講完全，反而建議學生可以透過買書、上線上的課程來相互補充。我那時衍生了一個口頭禪是「聽一次聽不懂」 "],
["part-part-i-r-basic.html", "Chapter 1 (PART) Part I R Basic", " Chapter 1 (PART) Part I R Basic "],
["r-.html", "Chapter 2 R語言基礎速遊 2.1 RStudio 基本操作 2.2 用R載入資料 2.3 儲存現有變數 2.4 查詢函式的定義", " Chapter 2 R語言基礎速遊 2.1 RStudio 基本操作 2.1.1 執行R Markdown Using Cmd+Enter (Ctrl+Enter in Window) to excute the line where your cursor is located. Using Cmd(Ctrl)+Shift+Enter to run all code in a cell Using Cmd(Ctrl)+Option(Alt)+i to insert a new cell Using mouse to select multiple lines, then Cmd(Ctrl)+Shift+c to comment/uncomment multiple lines. a &lt;- c(1, 2, 3, 4, 5) b &lt;- 4 a*b ## [1] 4 8 12 16 20 2.1.2 安裝第三方套件 套件的使用分為安裝和載入兩個動作。通常安裝好R的時候就已經安裝好基本base套件。當執行R時便會將base套件預載入程式的執行環境中。非常多的R使用者會編寫第三方套件，並且將這些套件開放給群眾使用。通常這些套件已經被上載到R cran提供下載。而R cran上的套件我們可以使用install.packages(&quot;package_name&quot;)來自動安裝到我們的電腦中。 Exercise 2.1 (Installing packages) 安裝以下套件：tidyverse, caret, jiebaR, stm, sf 2.1.3 載入第三方套件 這些第三方套件被安裝好後，還需要被加載到程式的執行環境中才可以使用。因此要用library(package_name)將其載入。 library(jsonlite) ## Warning: package &#39;jsonlite&#39; was built under R version 3.5.2 library(httr) ## Warning: package &#39;httr&#39; was built under R version 3.5.2 Exercise 2.2 (Loading packages) 用library(package_name)載入已經安裝好的jsonlite與httr Exercise 2.3 (loading packages) 你可以用下面的程式碼一次載入多個套件。概念是，把你要安裝的套件名稱存成一個vector，然後偵測看看該套件是否已經安裝過了。如果有任何套件沒安裝過，就把那些套件給安裝了。 2.1.4 註解 下列程式碼中開頭有#符號者為註解，程式在執行時會自動忽略前面有#符號的程式碼。 # a &lt;- c(1, 2, 3, 4, 5) # b &lt;- 4 # a*b 2.2 用R載入資料 你這時候可能還沒用過R，先不要管以下每一行程式是什麼意思，就先使用看看、玩玩看。先看看RStudio怎麼執行R的程式，先看看R的資料長什麼樣子。 2.2.1 範例一：載入Dcard資料 先不要去管以下程式碼fromJSON(content(GET(url), &quot;text&quot;))是什麼意思，先著重在語言的形式。通常一個函式會寫為func_name()，所以上述其實是三個函式由內而外一層套一層，從最內層開始往外做。這其實很make-sense，因為如果你有一個數學式(1 + (3-3)/2)/8，也是會從最裡面那層做出來。 url &lt;- &quot;https://www.dcard.tw/_api/forums/relationship/posts?popular=true&quot; res &lt;- fromJSON(content(GET(url), &quot;text&quot;)) dplyr::glimpse(res) ## Observations: 30 ## Variables: 33 ## $ id &lt;int&gt; 233084983, 233086073, 233084150, 233084588, 23308… ## $ title &lt;chr&gt; &quot;給所有男性，你被綠了！如果你的女友......&quot;, &quot;打了曖昧對象一巴掌#更&quot;, &quot;女友睡覺一定… ## $ excerpt &lt;chr&gt; &quot;如標題，我發現了一切，我想告誡你，如果你的女朋友：1. Line名稱叫 bobo，2. 年紀26… ## $ anonymousSchool &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, FALSE, TRUE, FALSE,… ## $ anonymousDepartment &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, T… ## $ pinned &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, … ## $ forumId &lt;chr&gt; &quot;42851318-b9e2-4a75-8a05-9fe180becefe&quot;, &quot;42851318… ## $ replyId &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… ## $ createdAt &lt;chr&gt; &quot;2020-02-16T01:46:28.555Z&quot;, &quot;2020-02-16T06:49:55.… ## $ updatedAt &lt;chr&gt; &quot;2020-02-16T01:47:21.823Z&quot;, &quot;2020-02-17T02:59:03.… ## $ commentCount &lt;int&gt; 272, 33, 144, 40, 160, 28, 47, 43, 13, 26, 13, 12… ## $ likeCount &lt;int&gt; 4449, 2172, 1621, 1595, 1195, 799, 750, 689, 268,… ## $ withNickname &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, … ## $ tags &lt;list&gt; [&quot;HIDE_THUMBNAIL&quot;, &lt;&gt;, &lt;&gt;, &lt;&gt;, &lt;&gt;, &lt;&gt;, &lt;&gt;, &lt;&gt;, &lt;… ## $ topics &lt;list&gt; [&lt;&quot;愛情&quot;, &quot;女友&quot;, &quot;感情&quot;, &quot;男性&quot;, &quot;結婚&quot;&gt;, &lt;&quot;愛情&quot;, &quot;曖昧&quot;, &quot;約… ## $ meta &lt;df[,1]&gt; &lt;data.frame[26 x 1]&gt; ## $ forumName &lt;chr&gt; &quot;感情&quot;, &quot;感情&quot;, &quot;感情&quot;, &quot;感情&quot;, &quot;感情&quot;, &quot;感情&quot;, &quot;感情&quot;, &quot;感情&quot;, &quot;… ## $ forumAlias &lt;chr&gt; &quot;relationship&quot;, &quot;relationship&quot;, &quot;relationship&quot;, &quot;… ## $ gender &lt;chr&gt; &quot;F&quot;, &quot;F&quot;, &quot;M&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;M&quot;,… ## $ replyTitle &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… ## $ mediaMeta &lt;list&gt; [&lt;data.frame[0 x 0]&gt;, &lt;data.frame[6 x 8]&gt;, &lt;data… ## $ reactions &lt;list&gt; [&lt;data.frame[6 x 2]&gt;, &lt;data.frame[3 x 2]&gt;, &lt;data… ## $ hidden &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, … ## $ customStyle &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N… ## $ isSuspiciousAccount &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, … ## $ layout &lt;chr&gt; &quot;classic&quot;, &quot;classic&quot;, &quot;classic&quot;, &quot;classic&quot;, &quot;clas… ## $ withImages &lt;lgl&gt; FALSE, TRUE, TRUE, TRUE, FALSE, FALSE, TRUE, TRUE… ## $ withVideos &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, … ## $ media &lt;list&gt; [&lt;data.frame[0 x 0]&gt;, &lt;data.frame[5 x 1]&gt;, &lt;data… ## $ reportReasonText &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;… ## $ postAvatar &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;… ## $ school &lt;chr&gt; NA, NA, NA, NA, NA, &quot;國立高雄大學&quot;, NA, &quot;\\U0001f317&quot;, &quot;… ## $ department &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, &quot;brybry20&quot;, &quot;cocaaaa_… head(res) ## id title ## 1 233084983 給所有男性，你被綠了！如果你的女友...... ## 2 233086073 打了曖昧對象一巴掌#更 ## 3 233084150 女友睡覺一定要摸屌才能睡 ## 4 233084588 更）#閃 情人節男友送我口紅！？ ## 5 233084746 整天想摸奶是什麼概念？ ## 6 233084928 直球這麼明顯了 就差一步了…… ## excerpt ## 1 如標題，我發現了一切，我想告誡你，如果你的女朋友：1. Line名稱叫 bobo，2. 年紀26～27，3. 身高 160 左右，4. 在台北市的某銀行上班，5. Line照片是個人自拍照 長頭髮 ## 2 更，沒想到超多人回應的哈哈哈哈哈哈，我們之後當然在一起了 萬歲~~，我男朋友覺得他應該會記得這件事一輩子哈哈，祝大家趕快脫單呦~，______________正文__________，應該是發感情版吧 ## 3 我和現任女友是紫色交友軟體認識的，第一次約會就是去薰衣草森林看花花草草，然後就帶回家做愛了。然後就在一起（順序怪怪的？），第二次見面是在女友家過夜，我發現，她會一直強迫打手槍幾乎到快要天亮。我跟女友說 ## 4 不曉得該放美妝還是感情版，但既然有閃的部分，所以就選感情了，# # # 更新在 B32 唷，前天是情人節，原本有叫他不要送禮物，而且那天他還加班到很晚，他來我家之後，我完全沈浸在我的switch裡，根 ## 5 我男友不誇張幾乎每天都在跟我要，說真的有點煩 只要睡覺前躺在床上 他就會一直要摸我奶 我都會有點不開心跟他說不要 但過沒多久他還是會繼續摸...，只要口氣差的拒絕他 他就會鬧脾氣的不抱我睡覺...，說 ## 6 最近有個相處還不錯的對象，昨晚心血來潮，想說撩他一下，：我 ：他，以下為聊天紀錄，=============================，：我做什麼事都十拿九穩，但就是差你這一吻， ## anonymousSchool anonymousDepartment pinned ## 1 TRUE TRUE FALSE ## 2 TRUE TRUE FALSE ## 3 TRUE TRUE FALSE ## 4 TRUE TRUE FALSE ## 5 TRUE TRUE FALSE ## 6 FALSE TRUE FALSE ## forumId replyId createdAt ## 1 42851318-b9e2-4a75-8a05-9fe180becefe NA 2020-02-16T01:46:28.555Z ## 2 42851318-b9e2-4a75-8a05-9fe180becefe NA 2020-02-16T06:49:55.774Z ## 3 42851318-b9e2-4a75-8a05-9fe180becefe NA 2020-02-15T18:10:59.869Z ## 4 42851318-b9e2-4a75-8a05-9fe180becefe NA 2020-02-15T20:17:43.408Z ## 5 42851318-b9e2-4a75-8a05-9fe180becefe NA 2020-02-15T22:01:01.260Z ## 6 42851318-b9e2-4a75-8a05-9fe180becefe NA 2020-02-16T01:19:38.961Z ## updatedAt commentCount likeCount withNickname tags ## 1 2020-02-16T01:47:21.823Z 272 4449 FALSE HIDE_THUMBNAIL ## 2 2020-02-17T02:59:03.001Z 33 2172 FALSE ## 3 2020-02-15T18:16:07.940Z 144 1621 FALSE ## 4 2020-02-16T22:37:11.626Z 40 1595 FALSE ## 5 2020-02-15T22:01:01.260Z 160 1195 FALSE ## 6 2020-02-16T16:36:22.297Z 28 799 FALSE ## topics layout forumName forumAlias gender ## 1 愛情, 女友, 感情, 男性, 結婚 classic 感情 relationship F ## 2 愛情, 曖昧, 約會 classic 感情 relationship F ## 3 女友, 愛情, 打手槍, 感情, 分手 classic 感情 relationship M ## 4 情人節, 愛情, 口紅 classic 感情 relationship F ## 5 奶, 愛情 classic 感情 relationship F ## 6 直球, 愛情, 氣死, 曖昧 classic 感情 relationship F ## replyTitle ## 1 &lt;NA&gt; ## 2 &lt;NA&gt; ## 3 &lt;NA&gt; ## 4 &lt;NA&gt; ## 5 &lt;NA&gt; ## 6 &lt;NA&gt; ## mediaMeta ## 1 NULL ## 2 a38dd69c-c52c-477c-8ec8-7ae0d7ac42ae, a38dd69c-c52c-477c-8ec8-7ae0d7ac42ae, 923ec7df-510c-4197-9fb6-edbb42d0af89, 4ac99890-b56e-43c7-871e-0f834adfd744, f62e1a18-1a12-4e4d-a576-7d0a5d904c95, 30c4bbb1-38a8-4302-b6c6-55d791c50cd7, https://i.imgur.com/zdWZE8Kl.jpg, https://i.imgur.com/zdWZE8K.jpg, https://i.imgur.com/6RMIJ9E.jpg, https://i.imgur.com/W55VLqA.jpg, https://i.imgur.com/Our9jjE.jpg, https://i.imgur.com/OmZk3Bs.png, https://i.imgur.com/zdWZE8Kl.jpg, https://imgur.com/zdWZE8K, https://imgur.com/6RMIJ9E, https://imgur.com/W55VLqA, https://imgur.com/Our9jjE, https://imgur.com/OmZk3Bs, https://i.imgur.com/zdWZE8Kl.jpg, https://i.imgur.com/zdWZE8Kl.jpg, https://i.imgur.com/6RMIJ9El.jpg, https://i.imgur.com/W55VLqAl.jpg, https://i.imgur.com/Our9jjEl.jpg, https://i.imgur.com/OmZk3Bsl.jpg, image/thumbnail, image/imgur, image/imgur, image/imgur, image/imgur, image/imgur, ANNOTATED, ANNOTATED, ANNOTATED, ANNOTATED, ANNOTATED, ANNOTATED, 2020-02-16T06:49:55.774Z, 2020-02-16T06:49:55.774Z, 2020-02-16T06:49:55.774Z, 2020-02-16T06:49:55.774Z, 2020-02-16T06:49:55.774Z, 2020-02-16T06:49:55.774Z, 2020-02-17T02:59:03.001Z, 2020-02-17T02:59:03.001Z, 2020-02-17T02:59:03.001Z, 2020-02-17T02:59:03.001Z, 2020-02-17T02:59:03.001Z, 2020-02-17T02:59:03.001Z ## 3 8452d439-bc69-4cd9-a68f-d2a0400c3279, 8452d439-bc69-4cd9-a68f-d2a0400c3279, b5861979-5b6c-4d19-86e7-714ba4aefe5c, https://i.imgur.com/wprFVLfl.jpg, https://i.imgur.com/wprFVLf.jpg, https://i.imgur.com/NnLU68G.jpg, https://i.imgur.com/wprFVLfl.jpg, https://imgur.com/wprFVLf, https://imgur.com/NnLU68G, https://i.imgur.com/wprFVLfl.jpg, https://i.imgur.com/wprFVLfl.jpg, https://i.imgur.com/NnLU68Gl.jpg, image/thumbnail, image/imgur, image/imgur, ANNOTATED, ANNOTATED, ANNOTATED, 2020-02-15T18:10:59.869Z, 2020-02-15T18:10:59.869Z, 2020-02-15T18:10:59.869Z, 2020-02-15T18:16:07.940Z, 2020-02-15T18:16:07.940Z, 2020-02-15T18:16:07.940Z ## 4 ce16be9d-f0cc-47f6-903f-be253b744c05, ce16be9d-f0cc-47f6-903f-be253b744c05, f337325a-9832-4fb2-9c7f-df0f3bc5022a, https://megapx-assets.dcard.tw/images/26f7d047-a081-4ec4-8660-78049a3a4959/640.jpeg, https://megapx-assets.dcard.tw/images/26f7d047-a081-4ec4-8660-78049a3a4959/1280.jpeg, https://megapx-assets.dcard.tw/images/bde499bd-b8f6-4f33-a1fe-a2a6e0bbcf4a/full.jpeg, https://megapx-assets.dcard.tw/images/26f7d047-a081-4ec4-8660-78049a3a4959/640.jpeg, https://megapx.dcard.tw/v1/images/26f7d047-a081-4ec4-8660-78049a3a4959, https://megapx.dcard.tw/v1/images/bde499bd-b8f6-4f33-a1fe-a2a6e0bbcf4a, https://megapx-assets.dcard.tw/images/26f7d047-a081-4ec4-8660-78049a3a4959/640.jpeg, https://megapx-assets.dcard.tw/images/26f7d047-a081-4ec4-8660-78049a3a4959/640.jpeg, https://megapx-assets.dcard.tw/images/bde499bd-b8f6-4f33-a1fe-a2a6e0bbcf4a/640.jpeg, image/thumbnail, image/megapx, image/megapx, ANNOTATED, ANNOTATED, ANNOTATED, 2020-02-15T20:17:43.408Z, 2020-02-15T20:17:43.408Z, 2020-02-15T20:17:43.408Z, 2020-02-16T22:37:11.626Z, 2020-02-16T22:37:11.626Z, 2020-02-16T22:37:11.626Z, 296, 828, 650, 640, 1792, 906 ## 5 NULL ## 6 NULL ## reactions ## 1 286f599c-f86a-4932-82f0-f5a06f1eca03, 4b018f48-e184-445f-adf1-fc8e04ba09b9, aa0d425f-d530-4478-9a77-fe3aedc79eea, e8e6bc5d-41b0-4129-b134-97507523d7ff, 514c2569-fd53-4d9d-a415-bf0f88e7329f, 011ead16-9b83-4729-9fde-c588920c6c2d, 4331, 57, 41, 14, 5, 1 ## 2 286f599c-f86a-4932-82f0-f5a06f1eca03, e8e6bc5d-41b0-4129-b134-97507523d7ff, 4b018f48-e184-445f-adf1-fc8e04ba09b9, 1995, 175, 2 ## 3 286f599c-f86a-4932-82f0-f5a06f1eca03, e8e6bc5d-41b0-4129-b134-97507523d7ff, 4b018f48-e184-445f-adf1-fc8e04ba09b9, aa0d425f-d530-4478-9a77-fe3aedc79eea, 514c2569-fd53-4d9d-a415-bf0f88e7329f, 1503, 79, 36, 2, 1 ## 4 286f599c-f86a-4932-82f0-f5a06f1eca03, e8e6bc5d-41b0-4129-b134-97507523d7ff, 011ead16-9b83-4729-9fde-c588920c6c2d, 1573, 20, 2 ## 5 286f599c-f86a-4932-82f0-f5a06f1eca03, e8e6bc5d-41b0-4129-b134-97507523d7ff, aa0d425f-d530-4478-9a77-fe3aedc79eea, 4b018f48-e184-445f-adf1-fc8e04ba09b9, 514c2569-fd53-4d9d-a415-bf0f88e7329f, 011ead16-9b83-4729-9fde-c588920c6c2d, 1108, 43, 28, 11, 4, 1 ## 6 286f599c-f86a-4932-82f0-f5a06f1eca03, e8e6bc5d-41b0-4129-b134-97507523d7ff, 514c2569-fd53-4d9d-a415-bf0f88e7329f, 740, 58, 1 ## hidden customStyle isSuspiciousAccount layout withImages withVideos ## 1 FALSE NA FALSE classic FALSE FALSE ## 2 FALSE NA FALSE classic TRUE FALSE ## 3 FALSE NA FALSE classic TRUE FALSE ## 4 FALSE NA FALSE classic TRUE FALSE ## 5 FALSE NA FALSE classic FALSE FALSE ## 6 FALSE NA FALSE classic FALSE FALSE ## media ## 1 NULL ## 2 https://i.imgur.com/zdWZE8K.jpg, https://i.imgur.com/6RMIJ9E.jpg, https://i.imgur.com/W55VLqA.jpg, https://i.imgur.com/Our9jjE.jpg, https://i.imgur.com/OmZk3Bs.png ## 3 https://i.imgur.com/wprFVLf.jpg, https://i.imgur.com/NnLU68G.jpg ## 4 https://megapx-assets.dcard.tw/images/26f7d047-a081-4ec4-8660-78049a3a4959/1280.jpeg, https://megapx-assets.dcard.tw/images/bde499bd-b8f6-4f33-a1fe-a2a6e0bbcf4a/full.jpeg ## 5 NULL ## 6 NULL ## reportReasonText postAvatar school department ## 1 &lt;NA&gt; &lt;NA&gt; ## 2 &lt;NA&gt; &lt;NA&gt; ## 3 &lt;NA&gt; &lt;NA&gt; ## 4 &lt;NA&gt; &lt;NA&gt; ## 5 &lt;NA&gt; &lt;NA&gt; ## 6 國立高雄大學 &lt;NA&gt; # View(res) 2.2.2 範例二：讀取台北市竊盜案件發生地區與時間 方法一：直接讀取線上資料。這個方法會直接讀取一個URL(例如程式碼中url所指到的網址)，該URL指向台北市開放資料集所釋出的台北市竊盜案件發生時間與地點的開放資料。 可以用head(df)的程式碼來觀察看看他前六行的資料有哪些。 url &lt;- &quot;http://data.taipei/opendata/datalist/datasetMeta/download?id=68785231-d6c5-47a1-b001-77eec70bec02&amp;rid=34a4a431-f04d-474a-8e72-8d3f586db3df&quot; df &lt;- read.csv(url, fileEncoding = &quot;big5&quot;) head(df) ## 編號 案類 發生.現.日期 發生時段 ## 1 1 住宅竊盜 1040101 00~02 ## 2 2 住宅竊盜 1040101 00~02 ## 3 3 住宅竊盜 1040101 06~08 ## 4 4 住宅竊盜 1040101 10~12 ## 5 5 住宅竊盜 1040101 12~14 ## 6 6 住宅竊盜 1040102 00~02 ## 發生.現.地點 ## 1 台北市文山區萬美里萬寧街1~30號 ## 2 台北市信義區富台里忠孝東路5段295巷6弄1~30號 ## 3 台北市中山區新生北路1段91~120號 ## 4 台北市文山區明興里興隆路4段1~30號 ## 5 台北縣新莊市思源路332巷1~30號 ## 6 台北市士林區天福里1鄰忠誠路2段130巷1~30號 方法二：讀取已下載的資料檔案。有時候所拿到的資料是已經下載好的靜態資料檔案，可以用程式直接開啟本機端（Local）的檔案。第一行程式碼是把url所指向的檔案給抓回來並儲存到本機端的data資料夾中，並命名為tptheft.csv。第二行程式碼則是直接讀取該資料夾中的該檔案。 我在這邊用一個dplyr這個套件中的glimpse()函式來看看該筆資料的結構。可以看得出來有哪些變數，每個變數的前幾個範例值，以及變數的型態。 2.2.3 範例三：用API載入內政部資料 url &lt;- &quot;https://www.ris.gov.tw/rs-opendata/api/v1/datastore/ODRP024/107?page=1&quot; first_page &lt;- fromJSON(content(GET(url), &quot;text&quot;)) head(first_page$responseData) ## statistic_yyy district_code site_id village edu sex ## 1 107 65000010001 新北市板橋區 留侯里 博畢 男 ## 2 107 65000010001 新北市板橋區 留侯里 碩畢 男 ## 3 107 65000010001 新北市板橋區 留侯里 大畢 男 ## 4 107 65000010001 新北市板橋區 留侯里 專畢 男 ## 5 107 65000010001 新北市板橋區 留侯里 高中畢 男 ## 6 107 65000010001 新北市板橋區 留侯里 國中畢 男 ## headhousehold_count ## 1 3 ## 2 26 ## 3 71 ## 4 52 ## 5 122 ## 6 40 2.2.4 範例四：獲取104資料 url &lt;- &quot;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E7%88%AC%E8%9F%B2&amp;order=1&amp;asc=0&amp;page=3&amp;mode=s&amp;jobsource=2018indexpoc&quot; res &lt;- fromJSON(content(GET(url), &quot;text&quot;)) df &lt;- res$data$list head(df) ## jobType jobNo jobName ## 1 0 11397872 【軟體/網路/APP工程師】柬埔寨金邊職缺 ## 2 0 9161490 Python程式設計師 ## 3 0 8876423 C# / .Net 軟體工程師 ## 4 2 10964862 07_資料分析師 (中和) ## 5 2 11539015 Python數據⼯程師 ## 6 0 7468390 IT系統工程師 ## jobNameSnippet jobRole jobRo jobAddrNoDesc ## 1 【軟體/網路/APP工程師】柬埔寨金邊職缺 1 1 柬埔寨 ## 2 Python程式設計師 1 1 台中市南屯區 ## 3 C# / .Net 軟體工程師 1 1 台北市內湖區 ## 4 07_資料分析師 (中和) 1 1 新北市中和區 ## 5 Python數據⼯程師 1 1 台北市松山區 ## 6 IT系統工程師 1 1 台南市仁德區 ## jobAddress ## 1 ## 2 文心路一段521號7樓之1(鉅眾大樓) ## 3 堤頂大道二段179號10樓 ## 4 ## 5 光復北路95號7樓 ## 6 新田二街1號 ## description ## 1 \\r\\nGolang開發工程師\\r\\nH5工程師\\r\\nCocos開發工程師\\r\\n廣告演算法工程師\\r\\n伺服器程式(高級/中級)\\r\\n用戶端程式(高級/中級)\\r\\n[[[爬蟲]]]開發工程師\\r\\n運維工程師(基礎)\\r\\n運維工程師(業務/中級)\\r\\n運維工程師(開發/高級)\\r\\n\\r\\n\\r\\n ## 2 職責要求： \\r\\n1. [[[爬蟲]]]及程式維護。\\r\\n2. Python程式開發及維護。\\r\\n3. 系統技術研究與專案推動上線。\\r\\n4. 需輪值班。 \\r\\n\\r\\n任職資格： \\r\\n1. 熟悉 Flask/tornado等 Python API中的一個或多個。 ## 3 本團隊以C#及Vue.js 等技術進行開發[[[爬蟲]]]程式，\\r\\n工作項目，重點如下，其他細節，歡迎各位朋友來談談：\\r\\n1. 使用HangFire為基礎來開發及維護[[[爬蟲]]]程式。\\r\\n2. 網站開發：\\r\\n(1) Server 端,使用Asp.net Core ## 4 1.消費者行為資料探勘、資料前處理及建立預測模型，提出分析報告並以簡單精要的方式呈現相關發現及後續做法，創造管理層的數據化決策價值。\\n2.跨部門團隊合作大數據資料分析專案，針對發現之問題點提出建議改善，並有效率地掌控專案走向。\\n3.熟悉Python或使用R語言做資料分析。\\n4.其他主管交辦事項。 ## 5 ⼯作內容\\r\\n1.網路[[[爬蟲]]]開發\\r\\n2.Data cleanup and ETL \\r\\n3.負責數據流調度、監控及性能優化\\r\\n4.數據倉儲設計、優化及管理\\r\\n5.維護與改善現有數據流程\\r\\n6.相關流程⽂件撰寫\\r\\n7.其他主管交代事項\\r\\n\\r\\n必要條件： ## 6 開發新一代ERP系統\\r\\n1.後台商業邏輯Web API設計與實作(ASP.NET Core)\\r\\n2.前台網頁製作 (Angular)\\r\\n上述兩點依照個人能力可以只負責單一項目，可同時負責前後台者尤佳\\r\\n ## optionEdu period periodDesc applyCnt applyDesc custNo ## 1 專科 03 2年以上 00001 0~5人應徵 130000000139287 ## 2 專科 00 經歷不拘 00011 11~30人應徵 130000000079214 ## 3 專科 02 1年以上 00008 6~10人應徵 130000000085985 ## 4 大學 03 2年以上 00019 11~30人應徵 70769567000 ## 5 學歷不拘 04 3年以上 00010 6~10人應徵 130000000091152 ## 6 大學 00 經歷不拘 00005 0~5人應徵 22798584000 ## custName coIndustry coIndustryDesc salaryLow ## 1 Morning Air Technology PTE.LTD 1001001006 其它軟體及網路相關業 0000000 ## 2 雋上科技有限公司 1001001002 電腦軟體服務業 0030000 ## 3 辰城科技股份有限公司 1001001003 網際網路相關業 0000000 ## 4 台灣之星電信股份有限公司 1001002001 電信相關業 0000000 ## 5 電獺股份有限公司 1001001003 網際網路相關業 0045000 ## 6 恒耀工業股份有限公司 1002011010 其他金屬相關製造業 0000000 ## salaryHigh salaryDesc s10 appearDate appearDateDesc optionZone ## 1 0000000 待遇面議 10 20200113 1/13 8192 ## 2 0060000 月薪30,000~60,000元 50 20200120 1/20 0 ## 3 0000000 待遇面議 10 20200207 2/07 0 ## 4 0000000 待遇面議 10 20200205 2/05 6295680 ## 5 0070000 月薪45,000~70,000元 50 20200216 2/16 4096 ## 6 0000000 待遇面議 10 20200213 2/13 262144 ## isApply applyDate isSave ## 1 0 0 ## 2 0 0 ## 3 0 0 ## 4 0 0 ## 5 0 0 ## 6 0 0 ## descSnippet ## 1 \\r\\nGolang開發工程師\\r\\nH5工程師\\r\\nCocos開發工程師\\r\\n廣告演算法工程師\\r\\n伺服器程式(高級/中級)\\r\\n用戶端程式(高級/中級)\\r\\n&lt;em class=&#39;b-txt--highlight&#39;&gt;爬蟲&lt;/em&gt;開發工程師\\r\\n運維工程師(基礎)\\r\\n運維工程師(業務/中級)\\r\\n運維工程師(開發/高級)\\r\\n\\r\\n\\r\\n ## 2 職責要求： \\r\\n1. &lt;em class=&#39;b-txt--highlight&#39;&gt;爬蟲&lt;/em&gt;及程式維護。\\r\\n2. Python程式開發及維護。\\r\\n3. 系統技術研究與專案推動上線。\\r\\n4. 需輪值班。 \\r\\n\\r\\n任職資格： \\r\\n1. 熟悉 Flask/tornado等 Python API中的一個或多個。 ## 3 本團隊以C#及Vue.js 等技術進行開發&lt;em class=&#39;b-txt--highlight&#39;&gt;爬蟲&lt;/em&gt;程式，\\r\\n工作項目，重點如下，其他細節，歡迎各位朋友來談談：\\r\\n1. 使用HangFire為基礎來開發及維護&lt;em class=&#39;b-txt--highlight&#39;&gt;爬蟲&lt;/em&gt;程式。\\r\\n2. 網站開發：\\r\\n(1) Server 端,使用Asp.net Core ## 4 1.消費者行為資料探勘、資料前處理及建立預測模型，提出分析報告並以簡單精要的方式呈現相關發現及後續做法，創造管理層的數據化決策價值。\\n2.跨部門團隊合作大數據資料分析專案，針對發現之問題點提出建議改善，並有效率地掌控專案走向。\\n3.熟悉Python或使用R語言做資料分析。\\n4.其他主管交辦事項。 ## 5 ⼯作內容\\r\\n1.網路&lt;em class=&#39;b-txt--highlight&#39;&gt;爬蟲&lt;/em&gt;開發\\r\\n2.Data cleanup and ETL \\r\\n3.負責數據流調度、監控及性能優化\\r\\n4.數據倉儲設計、優化及管理\\r\\n5.維護與改善現有數據流程\\r\\n6.相關流程⽂件撰寫\\r\\n7.其他主管交代事項\\r\\n\\r\\n必要條件： ## 6 開發新一代ERP系統\\r\\n1.後台商業邏輯Web API設計與實作(ASP.NET Core)\\r\\n2.前台網頁製作 (Angular)\\r\\n上述兩點依照個人能力可以只負責單一項目，可同時負責前後台者尤佳\\r\\n ## tags ## 1 員工600人 ## 2 ## 3 員工135人 ## 4 ## 5 員工50人 ## 6 員工1000人 ## link.applyAnalyze ## 1 //www.104.com.tw/jobs/apply/analysis?j=6a784a744074512b5e60422940463e67540424a733c3e466f444a42252525252314e42607503j97&amp;channel=104rpt&amp;jobsource=apply_analyze ## 2 //www.104.com.tw/jobs/apply/analysis?j=3c60436c5e6c492034583a214e2e365f2383a426b34363e673c423a1d1d1d1d186464a363189j99&amp;channel=104rpt&amp;jobsource=apply_analyze ## 3 //www.104.com.tw/jobs/apply/analysis?j=57774a2f617350285d49432459353d6643f4149723b3d456e434941242424241f24b67493816j55&amp;channel=104rpt&amp;jobsource=apply_analyze ## 4 //www.104.com.tw/jobs/apply/analysis?j=50684b313c4e465e393a426b565c3f2196a684b2f3c74472929292928415c3a2d008j48&amp;channel=104rpt&amp;jobsource=apply_analyze ## 5 //www.104.com.tw/jobs/apply/analysis?j=494f48713d714e6e49473f695b333b6423d3f4770393b436c41473f22222222220493f3f2a37j57&amp;channel=104rpt&amp;jobsource=apply_analyze ## 6 //www.104.com.tw/jobs/apply/analysis?j=443a4426446c3f5631323a633c2e381975e4a44273c5c3e2121212121382b2625381j52&amp;channel=104rpt&amp;jobsource=apply_analyze ## link.job ## 1 //www.104.com.tw/job/6sank?jobsource=jolist_a_relevance ## 2 //www.104.com.tw/job/5gd1u?jobsource=jolist_a_relevance ## 3 //www.104.com.tw/job/5a93b?jobsource=jolist_a_relevance ## 4 //www.104.com.tw/job/6j0ji?jobsource=jolist_a_relevance ## 5 //www.104.com.tw/job/6vbk7?jobsource=jolist_a_relevance ## 6 //www.104.com.tw/job/4g2na?jobsource=jolist_a_relevance ## link.cust ## 1 //www.104.com.tw/company/1a2x6bkys7?jobsource=jolist_a_relevance ## 2 //www.104.com.tw/company/1a2x6bjofi?jobsource=jolist_a_relevance ## 3 //www.104.com.tw/company/1a2x6bjtnl?jobsource=jolist_a_relevance ## 4 //www.104.com.tw/company/wiedfdk?jobsource=jolist_a_relevance ## 5 //www.104.com.tw/company/1a2x6bjxn4?jobsource=jolist_a_relevance ## 6 //www.104.com.tw/company/ah1os00?jobsource=jolist_a_relevance ## jobsource jobNameRaw ## 1 jolist_a_relevance 【軟體/網路/APP工程師】柬埔寨金邊職缺 ## 2 jolist_a_relevance Python程式設計師 ## 3 jolist_a_relevance C# / .Net 軟體工程師 ## 4 jolist_a_relevance 07_資料分析師 (中和) ## 5 jolist_a_relevance Python數據⼯程師 ## 6 jolist_a_relevance IT系統工程師 ## custNameRaw ## 1 Morning Air Technology PTE.LTD ## 2 雋上科技有限公司 ## 3 辰城科技股份有限公司 ## 4 台灣之星電信股份有限公司 ## 5 電獺股份有限公司 ## 6 恒耀工業股份有限公司 2.2.5 範例五：獲取ubike資料 https://taipeicity.github.io/traffic_realtime/ url &lt;- &quot;https://tcgbusfs.blob.core.windows.net/blobyoubike/YouBikeTP.json&quot; ubike.list &lt;- fromJSON(content(GET(url),&quot;text&quot;, encoding = &quot;utf-8&quot;)) ubike.v &lt;- unlist(ubike.list$retVal) ubike.m &lt;- matrix(ubike.v, byrow = T, ncol = 14) ubike.df &lt;- as.data.frame(ubike.m) names(ubike.df) &lt;- names(ubike.list$retVal$`0001`) head(ubike.df) ## sno sna tot sbi sarea mday lat ## 1 0001 捷運市政府站(3號出口) 180 71 信義區 20200217111734 25.0408578889 ## 2 0002 捷運國父紀念館站(2號出口) 48 9 大安區 20200217111739 25.041254 ## 3 0003 台北市政府 40 21 信義區 20200217111715 25.0377972222 ## 4 0004 市民廣場 60 29 信義區 20200217111728 25.0360361111 ## 5 0005 興雅國中 60 17 信義區 20200217111727 25.0365638889 ## 6 0006 臺北南山廣場 80 20 信義區 20200217111726 25.034047 ## lng ar ## 1 121.567904444 忠孝東路/松仁路(東南側) ## 2 121.55742 忠孝東路四段/光復南路口(西南側) ## 3 121.565169444 台北市政府東門(松智路) (鄰近信義商圈/台北探索館) ## 4 121.562325 市府路/松壽路(西北側)(鄰近台北101/台北世界貿易中心/台北探索館) ## 5 121.5686639 松仁路/松仁路95巷(東南側)(鄰近信義商圈/台北信義威秀影城) ## 6 121.565973 松智路/松廉路(東北側) (鄰近台北101/信義商圈/台北信義威秀影城) ## sareaen snaen ## 1 Xinyi Dist. MRT Taipei City Hall Stataion(Exit 3)-2 ## 2 Daan Dist. MRT S.Y.S Memorial Hall Stataion(Exit 2.) ## 3 Xinyi Dist. Taipei City Hall ## 4 Xinyi Dist. Citizen Square ## 5 Xinyi Dist. Xingya Jr. High School ## 6 Xinyi Dist. NAN SHAN PLAZA ## aren bemp act ## 1 The S.W. side of Road Zhongxiao East Road &amp; Road Chung Yan. 106 1 ## 2 Sec,4. Zhongxiao E.Rd/GuangFu S. Rd 39 1 ## 3 Taipei City Government Eastgate (Song Zhi Road) 19 1 ## 4 The N.W. side of Road Shifu &amp; Road Song Shou. 29 1 ## 5 The S.E. side of Road Songren &amp; Ln. 95, Songren Rd.. 42 1 ## 6 The N.E. side of Road Song Zhi &amp; Road Song Lian. 60 1 2.3 儲存現有變數 R可以暫時把現在有的變數儲存成暫存檔。可以用save()或load()，或者用saveRDS()與readRDS()。也可以用readr套件的write_rds()與read_rds()。 用以下的指令可以一次把所有環境中的變項全部儲存成一個檔案。ls()可以列出目前執行環境下所有的變項，在save()時必須要用file=參數來指定所要儲存成的目標檔案。檔案名稱由於是一個字串，所以必須要用雙引號。 save(list=ls(), file = &quot;output/hateGirl.rda&quot;) 2.4 查詢函式的定義 使用R的時候會經常遇到沒看過的函式，或者根本忘記某個函式要怎麼用。像我這種記憶力不好的，兩個月沒寫R，稍微特殊一點的函式名稱我就忘記了。忘記用法還好，還經常整個函式的名稱都忘記了。這時候你就可以用help()的指令查詢函式的用法和套件的內容。例如以下是查詢summary()這個函式的用法，你也可以用縮寫的方式來寫，就函式名稱前面打個問號就好。 help(summary) ?summary "],
["vector.html", "Chapter 3 Vector Notes 3.1 Vector的基本操作 3.2 Vector的運算 3.3 Data types 3.4 Character operations", " Chapter 3 Vector Notes 在這一章節與下一章節data.frame，你會學到vector、factor、matrix、list與data.frame這些「資料型態」 * vector就它當是google或Excel試算表的一欄，就是一個變項或稱變數（variable）。 * data.frame要特別費心去看，因為通常我們看到的一個google sheet或一個EXCEL sheet就相當一個data.frame。data.frame其實相當於是「list of vector」的組成。 * factor和matrix就先自己看看，還沒碰到統計或者大量的數值資料時，暫時不會用到這兩種變數型態。matrix比較常在網絡資料或者文字資料等需要操作大型矩陣的時候會用。 有些資料型態非常雷同（例如matrix或data.frame都是將資料儲存為欄列型態的二維資料），但學習過程你要特別注意，不同的資料型態之間有什麼差異？ * matrix和data.frame有什麼差？ * factor和vector有什麼差？ * data.frame和list有什麼差？ 每一個資料型態有什麼操作 * 產生（creating）：怎麼新建一個這個資料型態？ * 選取（selecting columns）：我可不可以只要這幾項？ * 合併（merging or concatenating）：兩個這種資料型態可不可以疊在一起？ * 刪除（deleting, truncating）：怎麼把某一個或某幾個刪掉（要先選）？ * 轉換（type converting）：可不可以轉成另一種型態？ 在這邊我們使用各縣市平均每月薪資所得以及各縣市人口數兩筆範例資料來做練習。 3.1 Vector的基本操作 3.1.1 建立Vector 在程式碼中，只要是文字必用成對的雙引號或單引號包含其中，以區隔「變數」和「數字」。例如如果看到沒有雙引號的「英文字母」必定是變數名稱，或函式名稱。如果看到有雙引號的數字，那也是文字。 income &lt;- c(70100, 51300, 51100, 48400, 47600, 43000) county &lt;- c(&quot;台北&quot;, &quot;新北&quot;, &quot;桃園&quot;, &quot;高雄&quot;, &quot;台中&quot;, &quot;台南&quot;) population &lt;- c(2.6, 3.9, 2.2, 2.7, 2.8, 1.8) area &lt;- c(271.8, 2052.5, 1221, 2951.9, 2214.9, 2191.7) 用seq()建立一個連續而規律的vector。例如seq(11, 99, 11)的意思是，從11到99，每隔11取一個。 用a:b建立一個從a到b的連續整數。例如1:10會產生從1到10的十個數字。 a &lt;- seq(11, 99, 11) a ## [1] 11 22 33 44 55 66 77 88 99 b &lt;- 11:20 b ## [1] 11 12 13 14 15 16 17 18 19 20 產生一群符合某種分配的數列。例如runif()是指uniform分配，rnorm()是指常態分配；rnorm(1000, 1, 10)指的是產生1000個從1~10之間的數。 x &lt;- runif(1000, 1, 10) # uniform dist, n=1000 plot(density(x)) x &lt;- rnorm(1000, 1, 10) # uniform dist, n=1000 plot(density(x)) x &lt;- rnorm(10000000, 1, 10) # normal dist, n=1000 plot(density(x)) 3.1.2 查看Vector的內容 預覽、印出Vector的內容。在R裡面不用特別用print()來印出一個變數的內容。他像是matlab一樣，只要直接打出該變數的名稱，就代表要把其內容列印出來。 county ## [1] &quot;台北&quot; &quot;新北&quot; &quot;桃園&quot; &quot;高雄&quot; &quot;台中&quot; &quot;台南&quot; income ## [1] 70100 51300 51100 48400 47600 43000 head(county) ## [1] &quot;台北&quot; &quot;新北&quot; &quot;桃園&quot; &quot;高雄&quot; &quot;台中&quot; &quot;台南&quot; tail(county) ## [1] &quot;台北&quot; &quot;新北&quot; &quot;桃園&quot; &quot;高雄&quot; &quot;台中&quot; &quot;台南&quot; length(county) ## [1] 6 用View()檢視資料。你可以用View(county)將county的內容呈現在RStudio的預覽視窗上，是RStudio的使用者很常用的作法。 3.1.3 取出Vector部分內容: Subsetting, filtering It is important to know how to neglect first n or last n elements. For example, a[1:(length(a)-2)] will neglect the last two elements. Thinking why I need parentheses for length(a)-2 here. county ## [1] &quot;台北&quot; &quot;新北&quot; &quot;桃園&quot; &quot;高雄&quot; &quot;台中&quot; &quot;台南&quot; county[c(5, 3, 1)] # how about country[c(1, 3, 5)] ## [1] &quot;台中&quot; &quot;桃園&quot; &quot;台北&quot; county[3:6] # is it equal to country[c(3, 4, 5, 6)] ## [1] &quot;桃園&quot; &quot;高雄&quot; &quot;台中&quot; &quot;台南&quot; a &lt;- 11:19 a[3:length(a)] ## [1] 13 14 15 16 17 18 19 a[length(a):3] ## [1] 19 18 17 16 15 14 13 3.1.4 Deleting Without assignment, deletion won’t change original vectors b &lt;- 11:20 b[-(3:5)] ## [1] 11 12 16 17 18 19 20 b[-c(1, 3, 5)] ## [1] 12 14 16 17 18 19 20 b ## [1] 11 12 13 14 15 16 17 18 19 20 Correct deleting operations with assignment to replace original vector b &lt;- b[-(3:5)] b ## [1] 11 12 16 17 18 19 20 a &lt;- seq(11, 99, 11) a &lt;- a[-c(1, 3, 5)] a ## [1] 22 44 66 77 88 99 3.1.5 Concatinating Concatinating is quite useful for web crawling when you crawl article links page by page. You may be not sure the number of page you need to crawl. So you need to append entire new vector to old vector. It is concatinating. (“Appending” often means adding one new element at the end of data.) a &lt;- 1:10 a &lt;- c(a, 11) a ## [1] 1 2 3 4 5 6 7 8 9 10 11 b ## [1] 11 12 16 17 18 19 20 a &lt;- c(a, b) a ## [1] 1 2 3 4 5 6 7 8 9 10 11 11 12 16 17 18 19 20 a &lt;- c(a, a, b) a ## [1] 1 2 3 4 5 6 7 8 9 10 11 11 12 16 17 18 19 20 1 2 3 4 5 6 7 ## [26] 8 9 10 11 11 12 16 17 18 19 20 11 12 16 17 18 19 20 3.2 Vector的運算 3.2.1 Arithmetic operations a &lt;- 11:19 a + 3 ## [1] 14 15 16 17 18 19 20 21 22 a / 2 ## [1] 5.5 6.0 6.5 7.0 7.5 8.0 8.5 9.0 9.5 a %% 2 ## [1] 1 0 1 0 1 0 1 0 1 a %/% 2 ## [1] 5 6 6 7 7 8 8 9 9 a %% 2== 0 ## [1] FALSE TRUE FALSE TRUE FALSE TRUE FALSE TRUE FALSE a %% 2 != 0 ## [1] TRUE FALSE TRUE FALSE TRUE FALSE TRUE FALSE TRUE a[a%% 2 == 0] ## [1] 12 14 16 18 a[a%%2 != 0] ## [1] 11 13 15 17 19 a &lt;- a %% 2 # modular arithmetic, get the reminder a &lt;- a %/% 2 # Quotient 3.2.2 Logic comparisons a %% 2 == 0 # deteting odd/even number ## [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE a %% 2 != 0 ## [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE a[a%%2==0] ## [1] 0 0 0 0 0 0 0 0 0 a &gt; b ## Warning in a &gt; b: longer object length is not a multiple of shorter object ## length ## [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE income &gt; mean(income) ## [1] TRUE FALSE FALSE FALSE FALSE FALSE TRUE == T # == equal to, ## [1] TRUE TRUE != F # != Not equal to ## [1] TRUE any(a&gt;11) # is there any element larger than 1 ## [1] FALSE all(a&gt;11) # are all elements larger than 1 ## [1] FALSE 3.2.3 Subsetting by logic comparisons two methods to filter data from vectors, by index vector or a logical vector with equal length. a &lt;- seq(11, 55, 11) a[c(T, F, T, F, T)] ## [1] 11 33 55 a[a%%2==1] ## [1] 11 33 55 a%%2 ## [1] 1 0 1 0 1 a%%2==1 ## [1] TRUE FALSE TRUE FALSE TRUE a &lt;- c(&quot;你好&quot;,&quot;你好棒棒&quot;,&quot;你好棒&quot;,&quot;你真的好棒&quot;) a[nchar(a)&gt;3] ## [1] &quot;你好棒棒&quot; &quot;你真的好棒&quot; # which will return &quot;index-of&quot; a &lt;- seq(11, 55, 11) a[which(a%%2==1)] ## [1] 11 33 55 which(a%%2==1) ## [1] 1 3 5 3.2.4 Sorting and ordering sort(x)的結果必須用&lt;-覆蓋原本的x，此時的x才算被排序的結果。 order(x)函式會傳回x數值由小到大的索引。這個例子的結果是5, 4, 3, 6, 1, 2，也就是5位置的那個數最小、4那個位置的數次小、接下來3, 6, 1, 2。 x[order(x)]把order(x)結果（也就是c(5, 4, 3, 6, 1, 2)）傳給原本的x便會使得原本的x重新排序。通常order()的用途是，我們可以將兩個等長的variables例如var1和var2，依據var2來重新排序var1，例如var1[order(var2)]。 x &lt;- c(33, 55, 22, 13, 4, 24) sort(x) ## [1] 4 13 22 24 33 55 x &lt;- sort(x) # assign to replace original x order(x) ## [1] 1 2 3 4 5 6 x[order(x)] ## [1] 4 13 22 24 33 55 3.2.5 Built-in math functions a &lt;- 11:19 min(a); max(a); mean(a); median(a); sd(a) ## [1] 11 ## [1] 19 ## [1] 15 ## [1] 15 ## [1] 2.738613 log2(a) ## [1] 3.459432 3.584963 3.700440 3.807355 3.906891 4.000000 4.087463 4.169925 ## [9] 4.247928 log1p(a) ## [1] 2.484907 2.564949 2.639057 2.708050 2.772589 2.833213 2.890372 2.944439 ## [9] 2.995732 ?log1p 3.3 Data types 3.3.1 Checking data type mode(county) # character ## [1] &quot;character&quot; mode(income) # numeric ## [1] &quot;numeric&quot; mode(income &gt; mean(income)) # logical ## [1] &quot;logical&quot; testing &lt;- c(&quot;26.142&quot;, &quot;12.008&quot;, &quot;7.032&quot;, &quot;13.646&quot;, &quot;4.589&quot;) mode(testing) # character ## [1] &quot;character&quot; 3.3.2 Converting data type numeric vector可以用as.character(x)轉成charcter；logical vector可以用as.numeric(x)轉為numeric。概念上可以說是character &gt; numeric &gt; logical。 如果硬是在logical vector後附加一個numeric element的話，那就會整個vector被轉為numeric vector；相仿地，如果numeric vector後附加一個character element的話那整個vector就會被轉為character vector。 可以用sum()函式來計算logical vector有幾個TRUE值。例如sum(a%%2==1)就是計算a中有幾個奇數。TRUE可視為1、FALSE可視為0，所以加總起來就是TRUE有幾個。 income.c &lt;- as.character(income) population.c &lt;- as.numeric(population) a &lt;- seq(11, 99, 11) a &lt;- c(a, &quot;100&quot;) a &lt;- seq(11, 99, 11) sum(a%%2==1) ## [1] 5 3.4 Character operations 3.4.1 Character operations a &lt;- seq(11, 55, 11) paste(&quot;A&quot;, a) # concatenate ## [1] &quot;A 11&quot; &quot;A 22&quot; &quot;A 33&quot; &quot;A 44&quot; &quot;A 55&quot; paste0(&quot;A&quot;, a) # concatenate ## [1] &quot;A11&quot; &quot;A22&quot; &quot;A33&quot; &quot;A44&quot; &quot;A55&quot; "],
["dataframe.html", "Chapter 4 Dataframe Notes 4.1 建立data.frame 4.2 觀察data.frame 4.3 操作data frame 4.4 MORE", " Chapter 4 Dataframe Notes 一開始用Excel去想像抽象的語言。一欄（一直行、Column、一個變數）就是一個vector，所以可想像一個vector裡面應該資料型態要是一致的。常用基本資料型態包含numeric（數值型態）、character（文字型態）。單一一個Excel試算表就像一個list或data.frame。把好幾欄湊在一起，不同欄包含的資料形態就可能不同（有些欄是人名，有些欄是數字），湊在一起變成一個list，而data.frame就是一種特殊list的型態。 4.1 建立data.frame 4.1.1 範例一：手動輸入台北市行政區人口與面積 將資料Assign給變數。複製網頁上的資料，並把每個變項（例如區名、人口數、行政區面積）建立成vector，再分別Assign給變數。每個變項的vector必須等長（不是嗎？有幾個行政區，就要有幾個區的人口數，就要有幾個區的面積）。 population &lt;- c(158228, 126687, 228075, 204903, 308383, 187920) town &lt;- c(&quot;中正&quot;, &quot;大同&quot;, &quot;中山&quot;, &quot;松山&quot;, &quot;大安&quot;, &quot;萬華&quot;) area &lt;- c(7.6071, 5.6815, 13.6821, 9.2878, 11.3614, 8.8522) 將vectors整合成data.frame。使用data.frame()可以將數個等長的vetors整合成一個data.frame。就像一個EXCEL資料表。 df &lt;- data.frame(town, population, area) df ## town population area ## 1 中正 158228 7.6071 ## 2 大同 126687 5.6815 ## 3 中山 228075 13.6821 ## 4 松山 204903 9.2878 ## 5 大安 308383 11.3614 ## 6 萬華 187920 8.8522 # View(df) 4.1.2 範例二：手動輸入台灣的進出口對象與數量 這個案例是到台灣出口進口貿易資料查詢的網頁上，逐筆複製資料貼上。先建立三個vecvtors，再將vectors合併為data.frame。 country &lt;- c(&quot;CN&quot;, &quot;US&quot;, &quot;JP&quot;, &quot;HK&quot;, &quot;KR&quot;, &quot;SG&quot;, &quot;DE&quot;, &quot;MY&quot;, &quot;VN&quot;, &quot;PH&quot;, &quot;TH&quot;, &quot;AU&quot;, &quot;NL&quot;, &quot;SA&quot;, &quot;ID&quot;, &quot;GB&quot;, &quot;IN&quot;, &quot;FR&quot;, &quot;IT&quot;, &quot;AE&quot;) import &lt;- c(26.142, 12.008, 7.032, 13.646, 4.589, 5.768, 2.131, 2.802, 3.428, 3.019, 1.976, 1.118, 1.624, 0.449, 0.983, 1.302, 1.027, 0.553, 0.670, 0.455) export &lt;- c(22.987, 12.204, 11.837, 7.739, 5.381, 4.610, 2.866, 2.784, 2.414, 2.092, 1.839, 1.788, 1.665, 1.409, 1.391, 1.075, 0.974, 0.899, 0.800, 0.728) df &lt;- data.frame(country, import, export) str(df) ## &#39;data.frame&#39;: 20 obs. of 3 variables: ## $ country: Factor w/ 20 levels &quot;AE&quot;,&quot;AU&quot;,&quot;CN&quot;,..: 3 19 11 7 12 17 4 13 20 15 ... ## $ import : num 26.14 12.01 7.03 13.65 4.59 ... ## $ export : num 22.99 12.2 11.84 7.74 5.38 ... stringAsFacgtors參數設定: 這時若以str(df)觀察該df的結構會發現，文字型態的資料被轉為Factors，這是我們所不樂見的。過去統計通常會把文字型態當成類別變數，於是用Factors作為資料型態，但資料科學中經常要處理大量的文字資料。此時可以加入一個參數stringsAsFactors設為FALSE，意味著預設不要將文字的資料轉為Factor而是直接以文字變項來處理。 設定全域參數: 為了避免每次都要打這串參數，可以把它設定為全域參數，可以在程式一開始時便加上options(stringsAsFactors = FASLE)，意味著底下所有的函式如果有stringsAsFactors這個參數，一律自動設為FALSE。 df &lt;- data.frame(country, import, export, stringsAsFactors = FALSE) str(df) ## &#39;data.frame&#39;: 20 obs. of 3 variables: ## $ country: chr &quot;CN&quot; &quot;US&quot; &quot;JP&quot; &quot;HK&quot; ... ## $ import : num 26.14 12.01 7.03 13.65 4.59 ... ## $ export : num 22.99 12.2 11.84 7.74 5.38 ... 4.1.3 More 甚至也可以用data.frame()建立一個新的、空的data.frame。在別的程式語言中，這可能被稱為建構子或initializing。 命名規則：df.test就R的用法就是一個變數，並不是df和test各自是一個變數。 df.test &lt;- data.frame() 4.2 觀察data.frame View(df) 用RStudio所提供的GUI直接觀看變數 head(df) 取前面六筆資料（也就是六列的資料來概觀該資料） class(df) 這個變數的物件型態 str(df) 這個data.frame的結構，包含有哪些變數、各別是什麼變數型態，並呈現前幾個範例值。 summary(df) 輸出每個變數的最大值、最小值、平均數、中位數等基本統計數值。 dplyr::glimpse(df) 為dplyr套件中的函式。和str(df)的功能幾乎相同，但排版排的好太多了。 # View(df) head(df) # get first part of the data.frame ## country import export ## 1 CN 26.142 22.987 ## 2 US 12.008 12.204 ## 3 JP 7.032 11.837 ## 4 HK 13.646 7.739 ## 5 KR 4.589 5.381 ## 6 SG 5.768 4.610 class(df) ## [1] &quot;data.frame&quot; str(df) ## &#39;data.frame&#39;: 20 obs. of 3 variables: ## $ country: chr &quot;CN&quot; &quot;US&quot; &quot;JP&quot; &quot;HK&quot; ... ## $ import : num 26.14 12.01 7.03 13.65 4.59 ... ## $ export : num 22.99 12.2 11.84 7.74 5.38 ... summary(df) ## country import export ## Length:20 Min. : 0.449 Min. : 0.728 ## Class :character 1st Qu.: 1.016 1st Qu.: 1.312 ## Mode :character Median : 2.054 Median : 1.966 ## Mean : 4.536 Mean : 4.374 ## 3rd Qu.: 4.884 3rd Qu.: 4.803 ## Max. :26.142 Max. :22.987 dplyr::glimpse(df) ## Observations: 20 ## Variables: 3 ## $ country &lt;chr&gt; &quot;CN&quot;, &quot;US&quot;, &quot;JP&quot;, &quot;HK&quot;, &quot;KR&quot;, &quot;SG&quot;, &quot;DE&quot;, &quot;MY&quot;, &quot;VN&quot;, &quot;PH&quot;, &quot;… ## $ import &lt;dbl&gt; 26.142, 12.008, 7.032, 13.646, 4.589, 5.768, 2.131, 2.802, 3.… ## $ export &lt;dbl&gt; 22.987, 12.204, 11.837, 7.739, 5.381, 4.610, 2.866, 2.784, 2.… 4.2.1 觀察資料維度 dim(df) ## [1] 20 3 ncol(df) ## [1] 3 nrow(df) ## [1] 20 length(df) ## [1] 3 4.3 操作data frame 4.3.1 取出data frame中的一個變數 每個data frame的一欄、一個變數相當於是一個vector，可以嘗試把其中一個變數取出來做資料型態觀察。 * names(df) 列出變數名稱 * df$發生.現.地點 顯示該變數內容 * df$發生時段 顯示該變數內容 * length(df$發生時段) 顯示該變數的長度（相當於有幾個） names(df) ## [1] &quot;country&quot; &quot;import&quot; &quot;export&quot; head(df$發生.現.地點) ## NULL head(df$發生時段) ## NULL length(df$發生時段) ## [1] 0 summary(df) ## country import export ## Length:20 Min. : 0.449 Min. : 0.728 ## Class :character 1st Qu.: 1.016 1st Qu.: 1.312 ## Mode :character Median : 2.054 Median : 1.966 ## Mean : 4.536 Mean : 4.374 ## 3rd Qu.: 4.884 3rd Qu.: 4.803 ## Max. :26.142 Max. :22.987 4.3.2 mutate 透過運算產生新變數 這裡容易犯錯的是，要記得跟程式講說你要加總或四則運算的是哪個df的variable。 從下面的這個操作中，該data.frame會產生一個新的變數sub，這就相當於Excel中的某一行減去某一行，然後把資料放在新的一行。 df$sub &lt;- df$import - df$export 4.3.3 filter, select 篩選資料、選取變數 注意，要告訴程式import和export是哪個data.frame的。 df[,]為存取df中某個區段的數值或某個數值的方法。因此df[1, 1]會取出第一行第一列，也就是第一筆資料的第一個vector。df[2, 3]則會取出第二筆資料的第三個variable。 下面的例子nrow(df)為1894，有1894筆資料，所以自然df\\(import與df\\)export的長度都是1894。因此，比較這兩個變數的大小會得到一個長度為1894的boolean (logical) variable。因此把這個長度為1894、充滿TRUE和FALSE的logical vector丟進df的row之處，因為取自df，大小判斷式結果的長度自然和原本的df的列數相同。因此當這個TRUE/FALSE被丟在df的列之處，便會篩選出import大於p.xport的數值。 原本的df有五個variable，而上述的操作是篩選資料，所以被篩選的是列，因此行的數量、名稱都不會變。因此，我篩選完後，直接存取這個被篩選過的data.frame的country variable，自然是可以的。 df ## country import export sub ## 1 CN 26.142 22.987 3.155 ## 2 US 12.008 12.204 -0.196 ## 3 JP 7.032 11.837 -4.805 ## 4 HK 13.646 7.739 5.907 ## 5 KR 4.589 5.381 -0.792 ## 6 SG 5.768 4.610 1.158 ## 7 DE 2.131 2.866 -0.735 ## 8 MY 2.802 2.784 0.018 ## 9 VN 3.428 2.414 1.014 ## 10 PH 3.019 2.092 0.927 ## 11 TH 1.976 1.839 0.137 ## 12 AU 1.118 1.788 -0.670 ## 13 NL 1.624 1.665 -0.041 ## 14 SA 0.449 1.409 -0.960 ## 15 ID 0.983 1.391 -0.408 ## 16 GB 1.302 1.075 0.227 ## 17 IN 1.027 0.974 0.053 ## 18 FR 0.553 0.899 -0.346 ## 19 IT 0.670 0.800 -0.130 ## 20 AE 0.455 0.728 -0.273 names(df) ## [1] &quot;country&quot; &quot;import&quot; &quot;export&quot; &quot;sub&quot; nrow(df) ## [1] 20 # filter row data by column value df[df$import &gt; df$export,] ## country import export sub ## 1 CN 26.142 22.987 3.155 ## 4 HK 13.646 7.739 5.907 ## 6 SG 5.768 4.610 1.158 ## 8 MY 2.802 2.784 0.018 ## 9 VN 3.428 2.414 1.014 ## 10 PH 3.019 2.092 0.927 ## 11 TH 1.976 1.839 0.137 ## 16 GB 1.302 1.075 0.227 ## 17 IN 1.027 0.974 0.053 df[df$import &gt; df$export,]$country ## [1] &quot;CN&quot; &quot;HK&quot; &quot;SG&quot; &quot;MY&quot; &quot;VN&quot; &quot;PH&quot; &quot;TH&quot; &quot;GB&quot; &quot;IN&quot; df[df$import &gt; df$export,1] ## [1] &quot;CN&quot; &quot;HK&quot; &quot;SG&quot; &quot;MY&quot; &quot;VN&quot; &quot;PH&quot; &quot;TH&quot; &quot;GB&quot; &quot;IN&quot; # 1 row == a data.frame with only one data entry class(df[df$import &gt; df$export,1]) ## [1] &quot;character&quot; class(df[,1]) # character vector ## [1] &quot;character&quot; class(df[1,]) # data.frame ## [1] &quot;data.frame&quot; class(unlist(df[1, -1])) # filter the 1st row and select all columns except 1 ## [1] &quot;numeric&quot; 4.3.4 sorting 排序：按照某個變數排序 df.sorted &lt;- df[order(df$import),]會使得整個df照import的大小排序重新做排列。因為order(df$import)會把資料照指定順序排列後的位置傳回來，所以把他丟給df的列的位置，便會使得df的資料照指定的順序排列。 預設是由小到大，加上decreasing = T這個參數後變成由大而小。 # sort rows by df$import column df.sorted &lt;- df[order(df$import),] # View(df.sorted) # sort rows in decreasing order df.sorted &lt;- df[order(df$import, decreasing = T),] # add - to column in order() can sort in decreasing order df.sorted &lt;- df[order(-df$import),] head(df.sorted) ## country import export sub ## 1 CN 26.142 22.987 3.155 ## 4 HK 13.646 7.739 5.907 ## 2 US 12.008 12.204 -0.196 ## 3 JP 7.032 11.837 -4.805 ## 6 SG 5.768 4.610 1.158 ## 5 KR 4.589 5.381 -0.792 4.4 MORE 4.4.1 Plotting graphics::plot()為會預載入R的繪圖套件，如果希望繪圖的同時加上回歸線和資料點標籤的話，必須要三行一起執行。 # plot(df) # raise error, 1st column is a character vector plot(df[, 2:3]) plot(df[1:10, 2:3]) text(import, export, labels=country, cex= 0.5, pos=3) lines(1:25, 1:25, col=&#39;red&#39;) ?plot 4.4.2 Using dplyr library(dplyr) ## Warning: package &#39;dplyr&#39; was built under R version 3.5.2 ## ## Attaching package: &#39;dplyr&#39; ## The following objects are masked from &#39;package:stats&#39;: ## ## filter, lag ## The following objects are masked from &#39;package:base&#39;: ## ## intersect, setdiff, setequal, union df &lt;- data.frame(country, import, export, stringsAsFactors = F) df &lt;- mutate(df, sub = import - export) filter(df, import &gt; export) ## country import export sub ## 1 CN 26.142 22.987 3.155 ## 2 HK 13.646 7.739 5.907 ## 3 SG 5.768 4.610 1.158 ## 4 MY 2.802 2.784 0.018 ## 5 VN 3.428 2.414 1.014 ## 6 PH 3.019 2.092 0.927 ## 7 TH 1.976 1.839 0.137 ## 8 GB 1.302 1.075 0.227 ## 9 IN 1.027 0.974 0.053 select(df, c(1, 3)) ## country export ## 1 CN 22.987 ## 2 US 12.204 ## 3 JP 11.837 ## 4 HK 7.739 ## 5 KR 5.381 ## 6 SG 4.610 ## 7 DE 2.866 ## 8 MY 2.784 ## 9 VN 2.414 ## 10 PH 2.092 ## 11 TH 1.839 ## 12 AU 1.788 ## 13 NL 1.665 ## 14 SA 1.409 ## 15 ID 1.391 ## 16 GB 1.075 ## 17 IN 0.974 ## 18 FR 0.899 ## 19 IT 0.800 ## 20 AE 0.728 "]
]
